{% extends "base.html" %}
{% block title %}Restaurant profile{% endblock %}

{% block main %}
    <h1>{{ name }} -- Likes: {{ likes }}</h1>
    <h2>Phone: {{ phone }}</h2>
    <ul>
        {% if current_user.is_authenticated %}
            <iframe width="600" height="400" frameborder="0" scrolling="no" marginheight="0" marginwidth="0"
                    src="https://www.openstreetmap.org/export/embed.html?bbox={{ lon - 0.001 }}%2C{{ lat - 0.001 }}%2C{{ lon + 0.001 }}%2C{{ lat + 0.001 }}&amp;layer=mapnik&amp;marker={{ lat }}%2C{{ lon }}"
                    style="border: 1px solid black"></iframe><br/><small><a
                href="https://www.openstreetmap.org/#map=17/{{ lat }}/{{ lon }}">See it Larger</a></small>
            <form action="{{base_url}}/book_table">
                <button type="submit">Book!</button>
            </form>
        {% endif %}
    </ul>

    <section>
        <h3>Precautions:</h3>
        <ul>
            {% for precaution in precautions %}
                <li>
                    {{ precaution }}
                </li>
            {% endfor %}
        </ul>
    </section>

    <article>
        <h3>Reviews</h3>
        <!--Insert if empty check-->
        {% for review in reviews %}
            <section>
                <h5>{{ review.user.firstname }}, rating: {{ review.rating }}</h5>
                <p>{{ review.message }}</p>
            </section>
        {% endfor %}
        {% if session["role"] != "operator" and session["role"] != "authority" %}
            <section>
                <form method="POST">
                    <h3>Add your review</h3>
                    {{ form.hidden_tag() }}
                    <p>
                        {% if form.rating.errors %}
                            <ul class=errors>
                                {% for error in form.rating.errors %}
                                    <li>{{ error }}</li>
                                {% endfor %}
                            </ul>
                        {% endif %}
                    <label for="">
                        <span>{{ form.rating.label }}</span>
                    </label> {{ form.rating() }}
                    </p>
                    <p>
                        {% if form.message.errors %}
                            <ul>
                                {% for error in form.message.errors %}
                                    <li>{{ error }}</li>
                                {% endfor %}
                            </ul>
                        {% endif %}
                    <label for="Message">
                        <span>{{ form.message.label }}</span>
                    </label>
                    {{ form.message() }}
                    </p>
                    <p>
                        <input type="submit" value="Post">
                    </p>
                </form>
            </section>
        {% endif %}
    </article>

</ul>
<h3>Precautions:</h3>
<ul>
  {% for precaution in precautions: %}
  <li>
    {{precaution}}
  </li>
  {% endfor %}
</ul>
<h3>Menus:</h3>
<ul>
  {% for menu in menus: %}
  <li>
    {{menu.name}}
    <a href="{{base_url}}/show_menu/{{menu.id}}">Show details</a>
  </li>
  {% endfor %}
</ul>
<a href="/operator/restaurants/{{id}}/create_menu">Create new menu</a>
{% endblock %}